(this.webpackJsonpgridentio_new=this.webpackJsonpgridentio_new||[]).push([[0],{10:function(e,t,a){"use strict";a.r(t);var r=a(8),n=a(1),s=a(2),o=a(4),c=a(3),i=a(5),u=a(0),h=a.n(u),l=a(7),f=a.n(l),v=(a(15),h.a.forwardRef((function(e,t){var a;switch(e.value){case 1:a="bg-col1";break;case 2:a="bg-col2";break;case 3:a="bg-col3";break;default:a="bg-col4"}return h.a.createElement("button",{className:"square "+(e.highlight?"highlight":a),onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseUp:e.onMouseUp,onMouseDown:e.onMouseDown,ref:t},e.value)})));function d(e){return h.a.createElement("button",{className:"new-game-btn",onClick:e.onClick},"New Game!")}var m=function(e){function t(e){var a;Object(n.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).forwardRefs=[];for(var r=Array(5),s=r.length-1;s>=0;s--){r[s]=Array(5),a.forwardRefs[s]=[];for(var i=r[s].length-1;i>=0;i--)r[s][i]=y(),a.forwardRefs[s][i]=null}return a.state={squares:r,trace:[],points:0},a.lastTouch={x:-1,y:-1,type:null},a}return Object(i.a)(t,e),Object(s.a)(t,[{key:"restartGame",value:function(){this.forwardRefs=[];for(var e=Array(5),t=e.length-1;t>=0;t--){e[t]=Array(5),this.forwardRefs[t]=[];for(var a=e[t].length-1;a>=0;a--)e[t][a]=y(),this.forwardRefs[t][a]=null}this.setState({squares:e,trace:[],points:0}),this.lastTouch={x:-1,y:-1,type:null}}},{key:"handleTouch",value:function(e,t){var a=t.touches[0],r=-1,n=-1,s=0;if(a)for(var o=0;o<this.forwardRefs.length;o++)for(var c=0;c<this.forwardRefs[o].length;c++){var i=this.forwardRefs[o][c].current;if(i&&a){var u=i.getBoundingClientRect();u.left<=a.clientX&&a.clientX<u.right&&u.top<=a.clientY&&a.clientY<u.bottom&&(r=o,n=c,s++)}}else r=this.lastTouch[r],n=this.lastTouch[n];if(this.lastTouch[r]!==r||this.lastTouch[n]!==n||this.lastTouch[e]!==e){var h;switch(this.lastTouch={x:r,y:n,type:e},e){case"start":h="down";break;case"move":h="enter";break;case"end":case"cancel":default:h="up"}this.handleMouse(r,n,h),s>1&&console.log("Error: tracked more than one row",t,o,c,s)}}},{key:"handleMouse",value:function(e,t,a){if(this.hasMoreMoves())if(0===this.state.trace.length){if("down"===a){var n=this.state.trace.concat([{x:e,y:t}]);this.setState({trace:n})}}else{-1===e&&-1===t&&(a="up");var s=this.state.trace[this.state.trace.length-1];switch(e>-1&&t>-1&&!this.isAdjacent(e,t,s.x,s.y)&&this.setState({trace:[]}),a){case"enter":var o=this.isInTrace(e,t);o>-1?this.setState({trace:this.state.trace.splice(0,o+1)}):this.setState({trace:this.state.trace.concat([{x:e,y:t}])});break;case"up":if(-1===e&&-1===t){this.setState({trace:[]});break}var c=this.calculatePoints(),i=Object(r.a)(c,2),u=i[0],h=i[1];null!==h?this.setState({trace:[],points:this.state.points+u,squares:h}):this.setState({trace:[]})}}}},{key:"isInTrace",value:function(e,t){for(var a=0;a<this.state.trace.length;a++)if(this.state.trace[a].x===e&&this.state.trace[a].y===t)return a;return-1}},{key:"isAdjacent",value:function(e,t,a,r){var n=Math.abs(e-a),s=Math.abs(t-r);return 1===n&&0===s||0===n&&1===s}},{key:"calculatePoints",value:function(){var e=this.state.trace,t=this.state.squares;if(0===e.length||1===e.length)return[0,null];for(var a=t[e[0].x][e[1].y],r=a,n=1;n<e.length;n++){if(a!==t[e[n].x][e[n].y])return[0,null];r+=a}var s=Array(5);for(n=s.length-1;n>=0;n--){s[n]=Array(5);for(var o=s[n].length-1;o>=0;o--)s[n][o]=t[n][o]}for(n=0;n<e.length-1;n++)s[e[n].x][e[n].y]=y();return s[e[e.length-1].x][e[e.length-1].y]=r,[r,s]}},{key:"hasMoreMoves",value:function(){for(var e=0;e<5;e++)for(var t=e+1,a=0;a<5;a++){var r=a+1;if(t<5&&this.state.squares[e][a]===this.state.squares[t][a])return!0;if(r<5&&this.state.squares[e][a]===this.state.squares[e][r])return!0}return!1}},{key:"renderSquare",value:function(e,t,a){var r=this;return h.a.createElement(v,{value:this.state.squares[e][t],highlight:this.isInTrace(e,t)>-1,onMouseEnter:function(){return r.handleMouse(e,t,"enter")},onMouseUp:function(){return r.handleMouse(e,t,"up")},onMouseDown:function(){return r.handleMouse(e,t,"down")},key:e+"_"+t,ref:a})}},{key:"render",value:function(){for(var e=this,t=[],a=0;a<5;a++){for(var r=[],n=0;n<5;n++){var s=h.a.createRef();r.push(this.renderSquare(a,n,s)),this.forwardRefs[a][n]=s}t.push(h.a.createElement("div",{className:"board-row",key:a.toString()},r))}var o=this.hasMoreMoves(),c=(o?"Points: ":"Match ended. Points: ")+this.state.points,i=o?[]:[h.a.createElement(d,{onClick:function(){return e.restartGame()},key:"newGame"})];return h.a.createElement("div",null,h.a.createElement("div",{className:"game-board-inner"},h.a.createElement("div",{className:"board",onMouseLeave:function(){return e.handleMouse(-1,-1,"leave")},onTouchStart:function(t){return e.handleTouch("start",t)},onTouchMove:function(t){return e.handleTouch("move",t)},onTouchEnd:function(t){return e.handleTouch("end",t)},onTouchCancel:function(t){return e.handleTouch("cancel",t)}},t),h.a.createElement("div",{className:"clear"})),h.a.createElement("div",{className:"status"},c),i)}}]),t}(h.a.Component),g=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return h.a.createElement("div",{className:"game"},h.a.createElement("div",{className:"game-info"},"Game inspired by ",h.a.createElement("a",{href:"https://gridentify.com/"},"Gridentify")," with few changes."),h.a.createElement("div",{className:"game-board"},h.a.createElement(m,null)))}}]),t}(h.a.Component);function y(){return Math.floor(3*Math.random())+1}f.a.render(h.a.createElement(g,null),document.getElementById("root"))},15:function(e,t,a){},9:function(e,t,a){e.exports=a(10)}},[[9,1,2]]]);
//# sourceMappingURL=main.80a9890a.chunk.js.map